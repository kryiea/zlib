{"ast":null,"code":"import _toConsumableArray from \"D:/zlib/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.parse-int.js\";\nexport default {\n  name: 'SearchResults',\n  props: {\n    books: {\n      type: Array,\n      \"default\": function _default() {\n        return [];\n      }\n    },\n    platforms: {\n      type: Array,\n      \"default\": function _default() {\n        return [{\n          id: 'zlibrary',\n          name: 'Z-Library',\n          available: true,\n          total: 0\n        }];\n      }\n    },\n    hasSearched: {\n      type: Boolean,\n      \"default\": false\n    }\n  },\n  data: function data() {\n    return {\n      sortOrder: 'desc',\n      // 默认降序排列\n      debounceTimer: null,\n      exampleBooks: [{\n        title: '示例书籍 1',\n        author: '作者名称',\n        year: '2024',\n        pages: '300',\n        language: '简体中文',\n        filesize: '10 MB',\n        extension: 'PDF',\n        publisher: '示例出版社',\n        source: 'Z-Library',\n        platform_id: 'zlibrary'\n      }, {\n        title: '示例书籍 2',\n        author: '示例作者',\n        year: '2023',\n        pages: '250',\n        language: '英文',\n        filesize: '8 MB',\n        extension: 'EPUB',\n        publisher: 'Example Press',\n        source: 'Z-Library',\n        platform_id: 'zlibrary'\n      }]\n    };\n  },\n  computed: {\n    getSortTitle: function getSortTitle() {\n      switch (this.sortOrder) {\n        case 'none':\n          return '点击降序排列';\n        case 'desc':\n          return '点击升序排列';\n        case 'asc':\n          return '点击取消排序';\n        default:\n          return '默认排序标题';\n        // 根据需求调整\n      }\n    },\n    getSortIcon: function getSortIcon() {\n      switch (this.sortOrder) {\n        case 'none':\n          return 'bi-dash';\n        case 'desc':\n          return 'bi-sort-down';\n        case 'asc':\n          return 'bi-sort-up';\n        default:\n          return 'bi-dash';\n      }\n    },\n    sortedBooks: function sortedBooks() {\n      return this.sortBooks(this.books);\n    },\n    sortedExampleBooks: function sortedExampleBooks() {\n      return this.sortBooks(this.exampleBooks);\n    }\n  },\n  methods: {\n    toggleSort: function toggleSort() {\n      // 定义明确的排序状态顺序\n      var states = ['none', 'asc', 'desc'];\n      var currentIndex = states.indexOf(this.sortOrder);\n      var nextIndex = (currentIndex + 1) % states.length;\n      this.sortOrder = states[nextIndex];\n      // 持久化排序状态\n      try {\n        localStorage.setItem('bookSortOrder', this.sortOrder);\n      } catch (error) {\n        console.error('保存排序状态失败:', error);\n      }\n      // 通知父组件排序变化\n      this.$emit('sort-changed', this.sortOrder);\n    },\n    sortBooks: function sortBooks(books) {\n      var _this = this;\n      if (!books || !Array.isArray(books) || this.sortOrder === 'none') {\n        return books;\n      }\n      return _toConsumableArray(books).sort(function (a, b) {\n        var yearA = parseInt(a.year, 10) || 0;\n        var yearB = parseInt(b.year, 10) || 0;\n        if (yearA === yearB) {\n          return a.title.localeCompare(b.title);\n        }\n        return _this.sortOrder === 'asc' ? yearA - yearB : yearB - yearA;\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","props","books","type","Array","default","platforms","id","available","total","hasSearched","Boolean","data","sortOrder","debounceTimer","exampleBooks","title","author","year","pages","language","filesize","extension","publisher","source","platform_id","computed","getSortTitle","getSortIcon","sortedBooks","sortBooks","sortedExampleBooks","methods","toggleSort","states","currentIndex","indexOf","nextIndex","length","localStorage","setItem","error","console","$emit","_this","isArray","_toConsumableArray","sort","a","b","yearA","parseInt","yearB","localeCompare"],"sources":["D:\\zlib\\frontend\\src\\components\\SearchResults.vue"],"sourcesContent":["<template>\r\n  <div class=\"search-results\">\r\n    <!-- 平台状态栏 -->\r\n    <div class=\"platform-status-bar\" v-if=\"platforms.length > 0\">\r\n      <div class=\"platform-status-title\">搜索来源:</div>\r\n      <div class=\"platform-badges\">\r\n        <span v-for=\"platform in platforms\" \r\n              :key=\"platform.id\"\r\n              :class=\"['platform-badge', {'platform-badge-available': platform.available}]\">\r\n          {{ platform.name }}: {{ platform.available ? `找到 ${platform.total} 个结果` : '无结果' }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 搜索结果表格 -->\r\n    <div class=\"results-table\" v-if=\"books.length > 0\">\r\n      <div class=\"table-header\">\r\n        <div class=\"col-book-info\">\r\n          书籍信息\r\n          <button class=\"sort-button\" @click=\"toggleSort\" :title=\"getSortTitle\">\r\n            年份排序\r\n            <i class=\"bi\" :class=\"getSortIcon\"></i>\r\n          </button>\r\n        </div>\r\n        <div class=\"col-author\">作者</div>\r\n        <div class=\"col-publisher\">出版商</div>\r\n        <div class=\"col-link\">直达链接</div>\r\n        <div class=\"col-source\">来源平台</div>\r\n      </div>\r\n\r\n      <div class=\"table-row\" v-for=\"book in sortedBooks\" :key=\"book.isbn\">\r\n        <div class=\"col-book-info\">\r\n          <div class=\"book-title\">{{ book.title }}</div>\r\n          <div class=\"book-details\">\r\n            <span>{{ book.year }}</span>\r\n            <span>| {{ book.language }}</span>\r\n            <span>| {{ book.filesize }}</span>\r\n            <span>| {{ book.extension }}</span>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-author\">{{ book.author }}</div>\r\n        <div class=\"col-publisher\">{{ book.publisher }}</div>\r\n        <div class=\"col-link\">\r\n          <a :href=\"book.book_url\" target=\"_blank\" class=\"download-link\">\r\n            <i class=\"fas fa-download\"></i> 下载\r\n          </a>\r\n        </div>\r\n        <div class=\"col-source\">\r\n          <span :class=\"['source-badge', `source-${book.platform_id}`]\">\r\n            {{ book.source }}\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 无结果提示 -->\r\n    <div v-else-if=\"hasSearched\" class=\"no-results\">\r\n      未找到相关书籍\r\n    </div>\r\n\r\n    <!-- 默认示例书籍 -->\r\n    <div v-else class=\"example-books\">\r\n      <div class=\"example-title\">示例书籍</div>\r\n      <div class=\"results-table\">\r\n        <div class=\"table-header\">\r\n          <div class=\"col-book-info\">\r\n            书籍信息\r\n            <button class=\"sort-button\" @click=\"toggleSort\" :title=\"getSortTitle\">\r\n              年份排序\r\n              <i class=\"bi\" :class=\"getSortIcon\"></i>\r\n            </button>\r\n          </div>\r\n          <div class=\"col-author\">作者</div>\r\n          <div class=\"col-publisher\">出版商</div>\r\n          <div class=\"col-link\">直达链接</div>\r\n          <div class=\"col-source\">来源平台</div>\r\n        </div>\r\n        \r\n        <div class=\"table-row\" v-for=\"book in sortedExampleBooks\" :key=\"book.isbn\">\r\n          <div class=\"col-book-info\">\r\n            <div class=\"book-title\">{{ book.title }}</div>\r\n            <div class=\"book-details\">\r\n              <span>{{ book.year }}</span>\r\n              <span>| {{ book.language }}</span>\r\n              <span>| {{ book.filesize }}</span>\r\n              <span>| {{ book.extension }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-author\">{{ book.author }}</div>\r\n          <div class=\"col-publisher\">{{ book.publisher }}</div>\r\n          <div class=\"col-link\">\r\n            <button class=\"download-link\" disabled>\r\n              <i class=\"fas fa-download\"></i> 示例\r\n            </button>\r\n          </div>\r\n          <div class=\"col-source\">\r\n            <span class=\"source-badge\">{{ book.source }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'SearchResults',\r\n  props: {\r\n    books: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    platforms: {\r\n      type: Array,\r\n      default: () => [\r\n        { id: 'zlibrary', name: 'Z-Library', available: true, total: 0 }\r\n      ]\r\n    },\r\n    hasSearched: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      sortOrder: 'desc',  // 默认降序排列\r\n      debounceTimer: null,\r\n      exampleBooks: [\r\n        {\r\n          title: '示例书籍 1',\r\n          author: '作者名称',\r\n          year: '2024',\r\n          pages: '300',\r\n          language: '简体中文',\r\n          filesize: '10 MB',\r\n          extension: 'PDF',\r\n          publisher: '示例出版社',\r\n          source: 'Z-Library',\r\n          platform_id: 'zlibrary'\r\n        },\r\n        {\r\n          title: '示例书籍 2',\r\n          author: '示例作者',\r\n          year: '2023',\r\n          pages: '250',\r\n          language: '英文',\r\n          filesize: '8 MB',\r\n          extension: 'EPUB',\r\n          publisher: 'Example Press',\r\n          source: 'Z-Library',\r\n          platform_id: 'zlibrary'\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    getSortTitle() {\r\n      switch(this.sortOrder) {\r\n        case 'none':\r\n          return '点击降序排列';\r\n        case 'desc':\r\n          return '点击升序排列';\r\n        case 'asc':\r\n          return '点击取消排序';\r\n        default:\r\n          return '默认排序标题'; // 根据需求调整\r\n      }\r\n    },\r\n    getSortIcon() {\r\n      switch(this.sortOrder) {\r\n        case 'none':\r\n          return 'bi-dash';\r\n        case 'desc':\r\n          return 'bi-sort-down';\r\n        case 'asc':\r\n          return 'bi-sort-up';\r\n        default:\r\n          return 'bi-dash';\r\n      }\r\n    },\r\n    sortedBooks() {\r\n      return this.sortBooks(this.books);\r\n    },\r\n    sortedExampleBooks() {\r\n      return this.sortBooks(this.exampleBooks);\r\n    }\r\n  },\r\n  methods: {\r\n    toggleSort() {\r\n      // 定义明确的排序状态顺序\r\n      const states = ['none', 'asc', 'desc'];\r\n      const currentIndex = states.indexOf(this.sortOrder);\r\n      const nextIndex = (currentIndex + 1) % states.length;\r\n      this.sortOrder = states[nextIndex];\r\n      // 持久化排序状态\r\n      try {\r\n        localStorage.setItem('bookSortOrder', this.sortOrder);\r\n      } catch (error) {\r\n        console.error('保存排序状态失败:', error);\r\n      }\r\n      // 通知父组件排序变化\r\n      this.$emit('sort-changed', this.sortOrder);\r\n    },\r\n    sortBooks(books) {\r\n      if (!books || !Array.isArray(books) || this.sortOrder === 'none') {\r\n        return books;\r\n      }\r\n      return [...books].sort((a, b) => {\r\n        const yearA = parseInt(a.year, 10) || 0;\r\n        const yearB = parseInt(b.year, 10) || 0;\r\n\r\n        if (yearA === yearB) {\r\n          return a.title.localeCompare(b.title);\r\n        }\r\n\r\n        return this.sortOrder === 'asc' ? yearA - yearB : yearB - yearA;\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search-results {\r\n  margin-top: 20px;\r\n}\r\n\r\n.platform-status-bar {\r\n  margin-bottom: 1.5rem;\r\n  padding: 0.75rem 1rem;\r\n  background-color: #ffffff;\r\n  border-radius: 8px;\r\n  display: flex;\r\n  align-items: center;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.platform-status-title {\r\n  margin-right: 1rem;\r\n  font-weight: 500;\r\n  color: #374151;\r\n}\r\n\r\n.platform-badges {\r\n  display: flex;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.platform-badge {\r\n  padding: 0.375rem 0.75rem;\r\n  border-radius: 6px;\r\n  background-color: #e5e7eb;\r\n  color: #4b5563;\r\n  font-size: 0.875rem;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.platform-badge-available {\r\n  background-color: #10b981;\r\n  color: #ffffff;\r\n}\r\n\r\n.results-table {\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n  overflow: hidden;\r\n}\r\n\r\n.table-header {\r\n  display: grid;\r\n  grid-template-columns: 3fr 1fr 1fr 1fr 1fr;\r\n  background-color: #f9fafb;\r\n  padding: 1rem;\r\n  font-weight: 500;\r\n  color: #374151;\r\n  border-bottom: 1px solid #e5e7eb;\r\n}\r\n\r\n.table-row {\r\n  display: grid;\r\n  grid-template-columns: 3fr 1fr 1fr 1fr 1fr;\r\n  padding: 1rem;\r\n  border-bottom: 1px solid #e5e7eb;\r\n  transition: background-color 0.2s ease;\r\n}\r\n\r\n.table-row:hover {\r\n  background-color: #f9fafb;\r\n}\r\n\r\n.table-row:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.book-title {\r\n  font-weight: 500;\r\n  color: #111827;\r\n  margin-bottom: 0.375rem;\r\n}\r\n\r\n.book-details {\r\n  font-size: 0.875rem;\r\n  color: #6b7280;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.book-details span {\r\n  position: relative;\r\n}\r\n\r\n.book-details span:not(:last-child)::after {\r\n  content: \"•\";\r\n  margin-left: 0.5rem;\r\n  color: #d1d5db;\r\n}\r\n\r\n.download-link {\r\n  padding: 0.375rem 1rem;\r\n  background-color: #10b981;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  text-decoration: none;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5rem;\r\n  font-size: 0.875rem;\r\n  transition: all 0.2s ease;\r\n  min-width: 90px;\r\n  height: 32px;\r\n}\r\n\r\n.download-link:hover {\r\n  background-color: #059669;\r\n}\r\n\r\n.download-link:disabled {\r\n  background-color: #e5e7eb;\r\n  color: #9ca3af;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.source-badge {\r\n  padding: 0.375rem 0.75rem;\r\n  border-radius: 6px;\r\n  background-color: #10b981;\r\n  color: white;\r\n  font-size: 0.875rem;\r\n  font-weight: 500;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 32px;\r\n  min-width: 90px;\r\n}\r\n\r\n.source-zlibrary {\r\n  background-color: #10b981;\r\n}\r\n\r\n.no-results {\r\n  text-align: center;\r\n  padding: 3rem 1.5rem;\r\n  color: #6b7280;\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.example-books {\r\n  opacity: 0.8;\r\n}\r\n\r\n.example-title {\r\n  margin-bottom: 1rem;\r\n  font-weight: 500;\r\n  color: #4b5563;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.col-link {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.col-source {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.sort-button {\r\n  background: none;\r\n  border: none;\r\n  color: #4b5563;\r\n  cursor: pointer;\r\n  padding: 0.25rem 0.5rem;\r\n  margin-left: 0.5rem;\r\n  font-size: 0.875rem;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.25rem;\r\n  border-radius: 4px;\r\n  transition: all 0.2s ease;\r\n  user-select: none;\r\n}\r\n\r\n.sort-button:hover {\r\n  background-color: #e5e7eb;\r\n}\r\n\r\n.sort-button .bi {\r\n  font-size: 1rem;\r\n  line-height: 1;\r\n  transition: transform 0.2s ease;\r\n}\r\n\r\n.bi-sort-up {\r\n  transform: translateY(-1px);\r\n}\r\n\r\n.bi-sort-down {\r\n  transform: translateY(1px);\r\n}   \r\n\r\n.bi-dash {\r\n  opacity: 0.5;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
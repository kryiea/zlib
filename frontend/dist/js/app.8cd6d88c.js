(()=>{"use strict";var e={343:(e,s,a)=>{a(3792),a(3362),a(9085),a(9391);var t=a(3751),r=a(641),o={id:"app"},l={class:"container pb-5"},i={class:"app-content"};function n(e,s,a,t,n,c){var u=(0,r.g2)("SearchBar"),d=(0,r.g2)("SearchResults");return(0,r.uX)(),(0,r.CE)("div",o,[s[0]||(s[0]=(0,r.Lk)("nav",{class:"navbar navbar-expand-lg navbar-primary bg-primary"},[(0,r.Lk)("div",{class:"container"},[(0,r.Lk)("a",{class:"navbar-brand text-white",href:"#"},[(0,r.Lk)("i",{class:"bi bi-book-half"}),(0,r.eW)(" E-Book Search ")])])],-1)),(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.bF)(u,{onSearch:c.handleSearch},null,8,["onSearch"]),(0,r.bF)(d,{books:n.searchResults,platforms:n.platforms,hasSearched:n.hasSearched},null,8,["books","platforms","hasSearched"])])]),s[1]||(s[1]=(0,r.Fv)('<footer class="app-footer"><div class="container"><div class="footer-content"><div class="footer-logo"><i class="bi bi-book-half"></i> E-Book Search </div><div class="footer-text">© 2024 E-Book Search. 一站式电子书搜索平台</div></div></div></footer>',1))])}var c=a(4048),u=a(9201),d=a(388),b=(a(2062),a(2010),a(1454),a(33)),h={class:"search-bar mb-4"},k={class:"card shadow-sm"},p={class:"card-body p-4"},v={class:"form-group"},f={class:"input-group search-input-group mb-3"},m=["disabled"],L={key:0},g={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},y={key:0,class:"alert alert-danger mt-2 search-error"};function S(e,s,a,o,l,i){return(0,r.uX)(),(0,r.CE)("div",h,[(0,r.Lk)("div",k,[(0,r.Lk)("div",p,[s[6]||(s[6]=(0,r.Lk)("div",{class:"search-header mb-4"},[(0,r.Lk)("h3",{class:"search-title"},"📚 电子书搜索"),(0,r.Lk)("p",{class:"search-subtitle"},"快速找到您需要的电子书资源")],-1)),(0,r.Lk)("div",v,[(0,r.Lk)("div",f,[s[3]||(s[3]=(0,r.Lk)("span",{class:"input-group-text search-icon"},[(0,r.Lk)("i",{class:"bi bi-search"})],-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=function(e){return l.searchInput=e}),type:"text",class:"form-control form-control-lg search-input",placeholder:"输入书名、作者或ISBN码",onKeyup:s[1]||(s[1]=(0,t.jR)((function(){return i.handleSearch&&i.handleSearch.apply(i,arguments)}),["enter"])),autocomplete:"off"},null,544),[[t.Jo,l.searchInput]]),(0,r.Lk)("button",{onClick:s[2]||(s[2]=function(){return i.handleSearch&&i.handleSearch.apply(i,arguments)}),class:(0,b.C4)(["btn btn-primary btn-lg search-button",{"btn-loading":l.isSearching}]),disabled:!i.isValidInput},[l.isSearching?((0,r.uX)(),(0,r.CE)("span",g)):((0,r.uX)(),(0,r.CE)("span",L,"搜索"))],10,m)]),l.error?((0,r.uX)(),(0,r.CE)("div",y,[s[4]||(s[4]=(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),(0,r.eW)(" "+(0,b.v_)(l.error),1)])):(0,r.Q3)("",!0),s[5]||(s[5]=(0,r.Lk)("div",{class:"search-tips"},[(0,r.Lk)("i",{class:"bi bi-info-circle me-1"}),(0,r.Lk)("small",{class:"form-text"},"支持书名、作者或ISBN码（10位或13位数字）搜索")],-1))])])])])}a(7495),a(906),a(2762),a(6031);var C=a(4335);const x={name:"SearchBar",data:function(){return{searchInput:"",error:"",currentRequest:null,debounceTimeout:null,isSearching:!1}},computed:{isValidInput:function(){return this.searchInput.trim()&&!this.error}},watch:{searchInput:function(e){this.validateInput(e)}},methods:{validateInput:function(e){var s=e.trim();s&&/^\d+$/.test(s)&&10!==s.length&&13!==s.length?this.error="ISBN必须是10位或13位数字":this.error=""},handleSearch:function(){var e=this,s=this.searchInput.trim();s?(this.debounceTimeout&&(clearTimeout(this.debounceTimeout),console.log("已清除之前的防抖定时器")),this.currentRequest&&(this.currentRequest.cancel("新的搜索请求"),console.log("已取消之前的搜索请求"),this.currentRequest=null,this.isSearching=!1),this.isSearching?console.log("当前正在搜索，忽略新的搜索请求"):this.debounceTimeout=setTimeout((0,d.A)((0,c.A)().mark((function s(){var a,t,r;return(0,c.A)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(s.prev=0,a=e.searchInput.trim(),a){s.next=4;break}return s.abrupt("return");case 4:return t=C.A.CancelToken.source(),e.currentRequest=t,e.isSearching=!0,e.$emit("search-start"),console.log("开始搜索:",a),s.next=11,e.$emit("search",a,t.token);case 11:console.log("搜索成功:",a),s.next=24;break;case 14:if(s.prev=14,s.t0=s["catch"](0),!C.A.isCancel(s.t0)){s.next=19;break}return console.log("请求取消:",s.t0.message),s.abrupt("return");case 19:console.error("搜索错误:",s.t0),r="搜索请求失败，请重试",s.t0.response?r=s.t0.response.data.message||"服务器返回错误":s.t0.request&&(r="无法连接到服务器"),e.error="搜索失败: ".concat(r),e.$emit("search-error",s.t0);case 24:return s.prev=24,e.currentRequest=null,e.isSearching=!1,e.$emit("search-end"),console.log("搜索结束"),s.finish(24);case 30:case"end":return s.stop()}}),s,null,[[0,14,24,30]])}))),50)):this.error="请输入搜索内容"},beforeUnmount:function(){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.currentRequest&&this.currentRequest.cancel("组件卸载")}}};var _=a(6262);const E=(0,_.A)(x,[["render",S],["__scopeId","data-v-75615f84"]]),w=E;var I={class:"search-results"},O={key:0,class:"platform-status-bar"},B={class:"platform-badges"},X={key:1,class:"results-table"},A={class:"table-header"},R={class:"col-book-info"},T=["title"],W={class:"col-book-info"},z={class:"book-info-main"},j={class:"book-title"},q={key:0,class:"book-author"},F={class:"book-details"},Q={key:0,class:"book-detail-item"},P={key:1,class:"book-detail-item"},$={key:2,class:"book-detail-item"},K={key:3,class:"book-detail-item"},M={key:4,class:"book-detail-item"},N={class:"col-author"},U={class:"col-publisher"},Z={class:"col-link"},V=["href"],D={class:"col-source"},J={key:2,class:"no-results"},G={key:3,class:"example-books"},H={class:"results-table"},Y={class:"table-header"},ee={class:"col-book-info"},se=["title"],ae={class:"col-book-info"},te={class:"book-title"},re={class:"book-details"},oe={class:"book-detail-item"},le={class:"book-detail-item"},ie={class:"book-detail-item"},ne={class:"book-detail-item"},ce={class:"col-author"},ue={class:"col-publisher"},de={class:"col-source"},be={class:"source-badge"};function he(e,s,a,t,o,l){return(0,r.uX)(),(0,r.CE)("div",I,[a.platforms.length>0?((0,r.uX)(),(0,r.CE)("div",O,[s[2]||(s[2]=(0,r.Lk)("div",{class:"platform-status-title"},"搜索来源:",-1)),(0,r.Lk)("div",B,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.platforms,(function(e){return(0,r.uX)(),(0,r.CE)("span",{key:e.id,class:(0,b.C4)(["platform-badge",{"platform-badge-available":e.available}])},(0,b.v_)(e.name)+": "+(0,b.v_)(e.available?"找到 ".concat(e.total," 个结果"):"无结果"),3)})),128))])])):(0,r.Q3)("",!0),a.books.length>0?((0,r.uX)(),(0,r.CE)("div",X,[(0,r.Lk)("div",A,[(0,r.Lk)("div",R,[s[4]||(s[4]=(0,r.eW)(" 书籍信息 ")),(0,r.Lk)("button",{class:"sort-button",onClick:s[0]||(s[0]=function(){return l.toggleSort&&l.toggleSort.apply(l,arguments)}),title:l.getSortTitle},[s[3]||(s[3]=(0,r.eW)(" 年份排序 ")),(0,r.Lk)("i",{class:(0,b.C4)(["bi",l.getSortIcon])},null,2)],8,T)]),s[5]||(s[5]=(0,r.Lk)("div",{class:"col-author"},"作者",-1)),s[6]||(s[6]=(0,r.Lk)("div",{class:"col-publisher"},"出版商",-1)),s[7]||(s[7]=(0,r.Lk)("div",{class:"col-link"},"直达链接",-1)),s[8]||(s[8]=(0,r.Lk)("div",{class:"col-source"},"来源平台",-1))]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.sortedBooks,(function(e){return(0,r.uX)(),(0,r.CE)("div",{class:(0,b.C4)(["table-row",{"table-row-hover":!0}]),key:e.isbn},[(0,r.Lk)("div",W,[(0,r.Lk)("div",z,[(0,r.Lk)("div",j,(0,b.v_)(e.title),1),e.author?((0,r.uX)(),(0,r.CE)("div",q,(0,b.v_)(e.author),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",F,[e.year?((0,r.uX)(),(0,r.CE)("span",Q,[s[9]||(s[9]=(0,r.Lk)("i",{class:"bi bi-calendar3"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.year),1)])):(0,r.Q3)("",!0),e.language?((0,r.uX)(),(0,r.CE)("span",P,[s[10]||(s[10]=(0,r.Lk)("i",{class:"bi bi-translate"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.language),1)])):(0,r.Q3)("",!0),e.filesize?((0,r.uX)(),(0,r.CE)("span",$,[s[11]||(s[11]=(0,r.Lk)("i",{class:"bi bi-file-earmark"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.filesize),1)])):(0,r.Q3)("",!0),e.extension?((0,r.uX)(),(0,r.CE)("span",K,[s[12]||(s[12]=(0,r.Lk)("i",{class:"bi bi-file-earmark-text"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.extension),1)])):(0,r.Q3)("",!0),e.isbn?((0,r.uX)(),(0,r.CE)("span",M,[s[13]||(s[13]=(0,r.Lk)("i",{class:"bi bi-upc-scan"},null,-1)),(0,r.eW)(" ISBN: "+(0,b.v_)(e.isbn),1)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",N,(0,b.v_)(e.author),1),(0,r.Lk)("div",U,(0,b.v_)(e.publisher),1),(0,r.Lk)("div",Z,[(0,r.Lk)("a",{href:e.book_url,target:"_blank",class:"download-link"},s[14]||(s[14]=[(0,r.Lk)("i",{class:"bi bi-download"},null,-1),(0,r.eW)(" 下载 ")]),8,V)]),(0,r.Lk)("div",D,[(0,r.Lk)("span",{class:(0,b.C4)(["source-badge","source-".concat(e.platform_id)])},(0,b.v_)(e.source),3)])])})),128))])):a.hasSearched?((0,r.uX)(),(0,r.CE)("div",J,s[15]||(s[15]=[(0,r.Lk)("div",{class:"no-results-content"},[(0,r.Lk)("i",{class:"bi bi-search text-muted mb-3",style:{"font-size":"3rem"}}),(0,r.Lk)("h4",null,"未找到相关书籍"),(0,r.Lk)("p",{class:"text-muted"},"请尝试使用其他关键词搜索")],-1)]))):((0,r.uX)(),(0,r.CE)("div",G,[s[27]||(s[27]=(0,r.Lk)("div",{class:"example-title"},[(0,r.Lk)("i",{class:"bi bi-info-circle me-2"}),(0,r.eW)("示例书籍")],-1)),(0,r.Lk)("div",H,[(0,r.Lk)("div",Y,[(0,r.Lk)("div",ee,[s[17]||(s[17]=(0,r.eW)(" 书籍信息 ")),(0,r.Lk)("button",{class:"sort-button",onClick:s[1]||(s[1]=function(){return l.toggleSort&&l.toggleSort.apply(l,arguments)}),title:l.getSortTitle},[s[16]||(s[16]=(0,r.eW)(" 年份排序 ")),(0,r.Lk)("i",{class:(0,b.C4)(["bi",l.getSortIcon])},null,2)],8,se)]),s[18]||(s[18]=(0,r.Lk)("div",{class:"col-author"},"作者",-1)),s[19]||(s[19]=(0,r.Lk)("div",{class:"col-publisher"},"出版商",-1)),s[20]||(s[20]=(0,r.Lk)("div",{class:"col-link"},"直达链接",-1)),s[21]||(s[21]=(0,r.Lk)("div",{class:"col-source"},"来源平台",-1))]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.sortedExampleBooks,(function(e){return(0,r.uX)(),(0,r.CE)("div",{class:(0,b.C4)(["table-row",{"table-row-hover":!0}]),key:e.isbn},[(0,r.Lk)("div",ae,[(0,r.Lk)("div",te,(0,b.v_)(e.title),1),(0,r.Lk)("div",re,[(0,r.Lk)("span",oe,[s[22]||(s[22]=(0,r.Lk)("i",{class:"bi bi-calendar3"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.year),1)]),(0,r.Lk)("span",le,[s[23]||(s[23]=(0,r.Lk)("i",{class:"bi bi-translate"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.language),1)]),(0,r.Lk)("span",ie,[s[24]||(s[24]=(0,r.Lk)("i",{class:"bi bi-file-earmark"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.filesize),1)]),(0,r.Lk)("span",ne,[s[25]||(s[25]=(0,r.Lk)("i",{class:"bi bi-file-earmark-text"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.extension),1)])])]),(0,r.Lk)("div",ce,(0,b.v_)(e.author),1),(0,r.Lk)("div",ue,(0,b.v_)(e.publisher),1),s[26]||(s[26]=(0,r.Lk)("div",{class:"col-link"},[(0,r.Lk)("button",{class:"download-link",disabled:""},[(0,r.Lk)("i",{class:"bi bi-download"}),(0,r.eW)(" 示例 ")])],-1)),(0,r.Lk)("div",de,[(0,r.Lk)("span",be,(0,b.v_)(e.source),1)])])})),128))])]))])}var ke=a(5492);a(6910),a(8940);const pe={name:"SearchResults",props:{books:{type:Array,default:function(){return[]}},platforms:{type:Array,default:function(){return[{id:"zlibrary",name:"Z-Library",available:!0,total:0}]}},hasSearched:{type:Boolean,default:!1}},data:function(){return{sortOrder:"desc",debounceTimer:null,exampleBooks:[{title:"示例书籍 1",author:"作者名称",year:"2024",pages:"300",language:"简体中文",filesize:"10 MB",extension:"PDF",publisher:"示例出版社",source:"Z-Library",platform_id:"zlibrary"},{title:"示例书籍 2",author:"示例作者",year:"2023",pages:"250",language:"英文",filesize:"8 MB",extension:"EPUB",publisher:"Example Press",source:"Z-Library",platform_id:"zlibrary"}]}},computed:{getSortTitle:function(){switch(this.sortOrder){case"none":return"点击降序排列";case"desc":return"点击升序排列";case"asc":return"点击取消排序";default:return"默认排序标题"}},getSortIcon:function(){switch(this.sortOrder){case"none":return"bi-dash";case"desc":return"bi-sort-down";case"asc":return"bi-sort-up";default:return"bi-dash"}},sortedBooks:function(){return this.sortBooks(this.books)},sortedExampleBooks:function(){return this.sortBooks(this.exampleBooks)}},methods:{toggleSort:function(){switch(this.sortOrder){case"none":this.sortOrder="desc";break;case"desc":this.sortOrder="asc";break;case"asc":this.sortOrder="none";break;default:this.sortOrder="none"}this.persistSortOrder(this.sortOrder)},persistSortOrder:function(e){localStorage.setItem("bookSortOrder",e)},sortBooks:function(e){var s=this;return"none"===this.sortOrder?e:(0,ke.A)(e).sort((function(e,a){var t=parseInt(e.year,10)||0,r=parseInt(a.year,10)||0;return t===r?e.title.localeCompare(a.title):"asc"===s.sortOrder?t-r:r-t}))}}},ve=(0,_.A)(pe,[["render",he],["__scopeId","data-v-7bea03e2"]]),fe=ve,me={name:"App",components:{SearchBar:w,SearchResults:fe},data:function(){return{searchResults:[],platforms:[{id:"zlibrary",name:"Z-Library",available:!0,total:0}],hasSearched:!1}},methods:{handleSearch:function(e){var s=this;return(0,d.A)((0,c.A)().mark((function a(){var t,r;return(0,c.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,s.hasSearched=!0,s.searchResults=[],a.next=5,C.A.get("/api/zlibrary/s/".concat(encodeURIComponent(e)));case 5:t=a.sent,t.data&&(s.searchResults=t.data.books,t.data.platform_status&&(r=t.data.platform_status,s.platforms=[{id:r.id,name:r.name,available:r.available,total:r.total}])),a.next=14;break;case 9:a.prev=9,a.t0=a["catch"](0),console.error("Search failed:",a.t0),s.searchResults=[],s.platforms=s.platforms.map((function(e){return(0,u.A)((0,u.A)({},e),{},{available:!1,total:0})}));case 14:case"end":return a.stop()}}),a,null,[[0,9]])})))()}}},Le=(0,_.A)(me,[["render",n]]),ge=Le;var ye=(0,t.Ef)(ge);ye.mount("#app")}},s={};function a(t){var r=s[t];if(void 0!==r)return r.exports;var o=s[t]={exports:{}};return e[t].call(o.exports,o,o.exports,a),o.exports}a.m=e,(()=>{var e=[];a.O=(s,t,r,o)=>{if(!t){var l=1/0;for(u=0;u<e.length;u++){for(var[t,r,o]=e[u],i=!0,n=0;n<t.length;n++)(!1&o||l>=o)&&Object.keys(a.O).every((e=>a.O[e](t[n])))?t.splice(n--,1):(i=!1,o<l&&(l=o));if(i){e.splice(u--,1);var c=r();void 0!==c&&(s=c)}}return s}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[t,r,o]}})(),(()=>{a.d=(e,s)=>{for(var t in s)a.o(s,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s)})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};a.O.j=s=>0===e[s];var s=(s,t)=>{var r,o,[l,i,n]=t,c=0;if(l.some((s=>0!==e[s]))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(n)var u=n(a)}for(s&&s(t);c<l.length;c++)o=l[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},t=self["webpackChunkebook_search"]=self["webpackChunkebook_search"]||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var t=a.O(void 0,[504],(()=>a(343)));t=a.O(t)})();
//# sourceMappingURL=app.8cd6d88c.js.map
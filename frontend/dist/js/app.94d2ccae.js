(()=>{"use strict";var e={492:(e,a,s)=>{s(3792),s(3362),s(9085),s(9391);var t=s(3751),r=s(641),o={id:"app"},l={class:"container pb-5"},i={class:"app-content"};function n(e,a,s,t,n,c){var u=(0,r.g2)("SearchBar"),d=(0,r.g2)("SearchResults");return(0,r.uX)(),(0,r.CE)("div",o,[a[0]||(a[0]=(0,r.Lk)("nav",{class:"navbar navbar-expand-lg navbar-primary bg-primary"},[(0,r.Lk)("div",{class:"container"},[(0,r.Lk)("a",{class:"navbar-brand text-white",href:"#"},[(0,r.Lk)("i",{class:"bi bi-book-half"}),(0,r.eW)(" E-Book Search ")])])],-1)),(0,r.Lk)("div",l,[(0,r.Lk)("div",i,[(0,r.bF)(u,{onSearch:c.handleSearch},null,8,["onSearch"]),(0,r.bF)(d,{books:n.searchResults,platforms:n.platforms,hasSearched:n.hasSearched},null,8,["books","platforms","hasSearched"])])]),a[1]||(a[1]=(0,r.Fv)('<footer class="app-footer"><div class="container"><div class="footer-content"><div class="footer-logo"><i class="bi bi-book-half"></i> E-Book Search </div><div class="footer-text">© 2024 E-Book Search. 一站式电子书搜索平台</div></div></div></footer>',1))])}var c=s(4048),u=s(9201),d=s(388),b=(s(8706),s(2062),s(2010),s(1454),s(33)),h={class:"search-bar mb-4"},k={class:"card shadow-sm"},p={class:"card-body p-4"},v={class:"form-group"},f={class:"input-group search-input-group mb-3"},m=["disabled"],L={key:0},g={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},y={key:0,class:"alert alert-danger mt-2 search-error"};function S(e,a,s,o,l,i){return(0,r.uX)(),(0,r.CE)("div",h,[(0,r.Lk)("div",k,[(0,r.Lk)("div",p,[a[6]||(a[6]=(0,r.Lk)("div",{class:"search-header mb-4"},[(0,r.Lk)("h3",{class:"search-title"},"📚 电子书搜索"),(0,r.Lk)("p",{class:"search-subtitle"},"快速找到您需要的电子书资源")],-1)),(0,r.Lk)("div",v,[(0,r.Lk)("div",f,[a[3]||(a[3]=(0,r.Lk)("span",{class:"input-group-text search-icon"},[(0,r.Lk)("i",{class:"bi bi-search"})],-1)),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=function(e){return l.searchInput=e}),type:"text",class:"form-control form-control-lg search-input",placeholder:"输入书名、作者或ISBN码",onKeyup:a[1]||(a[1]=(0,t.jR)((function(){return i.handleSearch&&i.handleSearch.apply(i,arguments)}),["enter"])),autocomplete:"off"},null,544),[[t.Jo,l.searchInput]]),(0,r.Lk)("button",{onClick:a[2]||(a[2]=function(){return i.handleSearch&&i.handleSearch.apply(i,arguments)}),class:(0,b.C4)(["btn btn-primary btn-lg search-button",{"btn-loading":l.isSearching}]),disabled:!i.isValidInput},[l.isSearching?((0,r.uX)(),(0,r.CE)("span",g)):((0,r.uX)(),(0,r.CE)("span",L,"搜索"))],10,m)]),l.error?((0,r.uX)(),(0,r.CE)("div",y,[a[4]||(a[4]=(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),(0,r.eW)(" "+(0,b.v_)(l.error),1)])):(0,r.Q3)("",!0),a[5]||(a[5]=(0,r.Lk)("div",{class:"search-tips"},[(0,r.Lk)("i",{class:"bi bi-info-circle me-1"}),(0,r.Lk)("small",{class:"form-text"},"支持书名、作者或ISBN码（10位或13位数字）搜索")],-1))])])])])}s(7495),s(906),s(2762),s(6031);var C=s(4335);const x={name:"SearchBar",data:function(){return{searchInput:"",error:"",currentRequest:null,debounceTimeout:null,isSearching:!1}},computed:{isValidInput:function(){return this.searchInput.trim()&&!this.error}},watch:{searchInput:function(e){this.validateInput(e)}},methods:{validateInput:function(e){var a=e.trim();a&&/^\d+$/.test(a)&&10!==a.length&&13!==a.length?this.error="ISBN必须是10位或13位数字":this.error=""},handleSearch:function(){var e=this,a=this.searchInput.trim();a?(this.debounceTimeout&&(clearTimeout(this.debounceTimeout),console.log("已清除之前的防抖定时器")),this.currentRequest&&(this.currentRequest.cancel("新的搜索请求"),console.log("已取消之前的搜索请求"),this.currentRequest=null,this.isSearching=!1),this.isSearching?console.log("当前正在搜索，忽略新的搜索请求"):this.debounceTimeout=setTimeout((0,d.A)((0,c.A)().mark((function a(){var s,t,r;return(0,c.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,s=e.searchInput.trim(),s){a.next=4;break}return a.abrupt("return");case 4:return t=C.A.CancelToken.source(),e.currentRequest=t,e.isSearching=!0,e.$emit("search-start"),console.log("开始搜索:",s),a.next=11,e.$emit("search",s,t.token);case 11:console.log("搜索成功:",s),a.next=24;break;case 14:if(a.prev=14,a.t0=a["catch"](0),!C.A.isCancel(a.t0)){a.next=19;break}return console.log("请求取消:",a.t0.message),a.abrupt("return");case 19:console.error("搜索错误:",a.t0),r="搜索请求失败，请重试",a.t0.response?r=a.t0.response.data.message||"服务器返回错误":a.t0.request&&(r="无法连接到服务器"),e.error="搜索失败: ".concat(r),e.$emit("search-error",a.t0);case 24:return a.prev=24,e.currentRequest=null,e.isSearching=!1,e.$emit("search-end"),console.log("搜索结束"),a.finish(24);case 30:case"end":return a.stop()}}),a,null,[[0,14,24,30]])}))),50)):this.error="请输入搜索内容"},beforeUnmount:function(){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.currentRequest&&this.currentRequest.cancel("组件卸载")}}};var _=s(6262);const w=(0,_.A)(x,[["render",S],["__scopeId","data-v-75615f84"]]),E=w;var I={class:"search-results"},O={key:0,class:"platform-status-bar"},B={class:"platform-badges"},X={key:1,class:"results-table"},A={class:"table-header"},R={class:"col-book-info"},T=["title"],W={class:"col-book-info"},z={class:"book-info-main"},j={class:"book-title"},q={key:0,class:"book-author"},F={class:"book-details"},Q={key:0,class:"book-detail-item"},P={key:1,class:"book-detail-item"},$={key:2,class:"book-detail-item"},K={key:3,class:"book-detail-item"},M={key:4,class:"book-detail-item"},N={class:"col-author"},U={class:"col-publisher"},Z={class:"col-link"},V=["href"],D={class:"col-source"},J={key:2,class:"no-results"},G={key:3,class:"example-books"},H={class:"results-table"},Y={class:"table-header"},ee={class:"col-book-info"},ae=["title"],se={class:"col-book-info"},te={class:"book-title"},re={class:"book-details"},oe={class:"book-detail-item"},le={class:"book-detail-item"},ie={class:"book-detail-item"},ne={class:"book-detail-item"},ce={class:"col-author"},ue={class:"col-publisher"},de={class:"col-source"},be={class:"source-badge"};function he(e,a,s,t,o,l){return(0,r.uX)(),(0,r.CE)("div",I,[s.platforms.length>0?((0,r.uX)(),(0,r.CE)("div",O,[a[2]||(a[2]=(0,r.Lk)("div",{class:"platform-status-title"},"搜索来源:",-1)),(0,r.Lk)("div",B,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.platforms,(function(e){return(0,r.uX)(),(0,r.CE)("span",{key:e.id,class:(0,b.C4)(["platform-badge",{"platform-badge-available":e.available}])},(0,b.v_)(e.name)+": "+(0,b.v_)(e.available?"找到 ".concat(e.total," 个结果"):"无结果"),3)})),128))])])):(0,r.Q3)("",!0),s.books.length>0?((0,r.uX)(),(0,r.CE)("div",X,[(0,r.Lk)("div",A,[(0,r.Lk)("div",R,[a[4]||(a[4]=(0,r.eW)(" 书籍信息 ")),(0,r.Lk)("button",{class:"sort-button",onClick:a[0]||(a[0]=function(){return l.toggleSort&&l.toggleSort.apply(l,arguments)}),title:l.getSortTitle},[a[3]||(a[3]=(0,r.eW)(" 年份排序 ")),(0,r.Lk)("i",{class:(0,b.C4)(["bi",l.getSortIcon])},null,2)],8,T)]),a[5]||(a[5]=(0,r.Lk)("div",{class:"col-author"},"作者",-1)),a[6]||(a[6]=(0,r.Lk)("div",{class:"col-publisher"},"出版商",-1)),a[7]||(a[7]=(0,r.Lk)("div",{class:"col-link"},"直达链接",-1)),a[8]||(a[8]=(0,r.Lk)("div",{class:"col-source"},"来源平台",-1))]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.sortedBooks,(function(e){return(0,r.uX)(),(0,r.CE)("div",{class:(0,b.C4)(["table-row",{"table-row-hover":!0}]),key:e.isbn},[(0,r.Lk)("div",W,[(0,r.Lk)("div",z,[(0,r.Lk)("div",j,(0,b.v_)(e.title),1),e.author?((0,r.uX)(),(0,r.CE)("div",q,(0,b.v_)(e.author),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",F,[e.year?((0,r.uX)(),(0,r.CE)("span",Q,[a[9]||(a[9]=(0,r.Lk)("i",{class:"bi bi-calendar3"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.year),1)])):(0,r.Q3)("",!0),e.language?((0,r.uX)(),(0,r.CE)("span",P,[a[10]||(a[10]=(0,r.Lk)("i",{class:"bi bi-translate"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.language),1)])):(0,r.Q3)("",!0),e.filesize?((0,r.uX)(),(0,r.CE)("span",$,[a[11]||(a[11]=(0,r.Lk)("i",{class:"bi bi-file-earmark"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.filesize),1)])):(0,r.Q3)("",!0),e.extension?((0,r.uX)(),(0,r.CE)("span",K,[a[12]||(a[12]=(0,r.Lk)("i",{class:"bi bi-file-earmark-text"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.extension),1)])):(0,r.Q3)("",!0),e.isbn?((0,r.uX)(),(0,r.CE)("span",M,[a[13]||(a[13]=(0,r.Lk)("i",{class:"bi bi-upc-scan"},null,-1)),(0,r.eW)(" ISBN: "+(0,b.v_)(e.isbn),1)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",N,(0,b.v_)(e.author),1),(0,r.Lk)("div",U,(0,b.v_)(e.publisher),1),(0,r.Lk)("div",Z,[(0,r.Lk)("a",{href:e.book_url,target:"_blank",class:"download-link"},a[14]||(a[14]=[(0,r.Lk)("i",{class:"bi bi-download"},null,-1),(0,r.eW)(" 下载 ")]),8,V)]),(0,r.Lk)("div",D,[(0,r.Lk)("span",{class:(0,b.C4)(["source-badge","source-".concat(e.platform_id)])},(0,b.v_)(e.source),3)])])})),128))])):s.hasSearched?((0,r.uX)(),(0,r.CE)("div",J,a[15]||(a[15]=[(0,r.Lk)("div",{class:"no-results-content"},[(0,r.Lk)("i",{class:"bi bi-search text-muted mb-3",style:{"font-size":"3rem"}}),(0,r.Lk)("h4",null,"未找到相关书籍"),(0,r.Lk)("p",{class:"text-muted"},"请尝试使用其他关键词搜索")],-1)]))):((0,r.uX)(),(0,r.CE)("div",G,[a[27]||(a[27]=(0,r.Lk)("div",{class:"example-title"},[(0,r.Lk)("i",{class:"bi bi-info-circle me-2"}),(0,r.eW)("示例书籍")],-1)),(0,r.Lk)("div",H,[(0,r.Lk)("div",Y,[(0,r.Lk)("div",ee,[a[17]||(a[17]=(0,r.eW)(" 书籍信息 ")),(0,r.Lk)("button",{class:"sort-button",onClick:a[1]||(a[1]=function(){return l.toggleSort&&l.toggleSort.apply(l,arguments)}),title:l.getSortTitle},[a[16]||(a[16]=(0,r.eW)(" 年份排序 ")),(0,r.Lk)("i",{class:(0,b.C4)(["bi",l.getSortIcon])},null,2)],8,ae)]),a[18]||(a[18]=(0,r.Lk)("div",{class:"col-author"},"作者",-1)),a[19]||(a[19]=(0,r.Lk)("div",{class:"col-publisher"},"出版商",-1)),a[20]||(a[20]=(0,r.Lk)("div",{class:"col-link"},"直达链接",-1)),a[21]||(a[21]=(0,r.Lk)("div",{class:"col-source"},"来源平台",-1))]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.sortedExampleBooks,(function(e){return(0,r.uX)(),(0,r.CE)("div",{class:(0,b.C4)(["table-row",{"table-row-hover":!0}]),key:e.isbn},[(0,r.Lk)("div",se,[(0,r.Lk)("div",te,(0,b.v_)(e.title),1),(0,r.Lk)("div",re,[(0,r.Lk)("span",oe,[a[22]||(a[22]=(0,r.Lk)("i",{class:"bi bi-calendar3"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.year),1)]),(0,r.Lk)("span",le,[a[23]||(a[23]=(0,r.Lk)("i",{class:"bi bi-translate"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.language),1)]),(0,r.Lk)("span",ie,[a[24]||(a[24]=(0,r.Lk)("i",{class:"bi bi-file-earmark"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.filesize),1)]),(0,r.Lk)("span",ne,[a[25]||(a[25]=(0,r.Lk)("i",{class:"bi bi-file-earmark-text"},null,-1)),(0,r.eW)(" "+(0,b.v_)(e.extension),1)])])]),(0,r.Lk)("div",ce,(0,b.v_)(e.author),1),(0,r.Lk)("div",ue,(0,b.v_)(e.publisher),1),a[26]||(a[26]=(0,r.Lk)("div",{class:"col-link"},[(0,r.Lk)("button",{class:"download-link",disabled:""},[(0,r.Lk)("i",{class:"bi bi-download"}),(0,r.eW)(" 示例 ")])],-1)),(0,r.Lk)("div",de,[(0,r.Lk)("span",be,(0,b.v_)(e.source),1)])])})),128))])]))])}var ke=s(5492);s(6910),s(8940);const pe={name:"SearchResults",props:{books:{type:Array,default:function(){return[]}},platforms:{type:Array,default:function(){return[{id:"zlibrary",name:"Z-Library",available:!0,total:0}]}},hasSearched:{type:Boolean,default:!1}},data:function(){return{sortOrder:"desc",debounceTimer:null,exampleBooks:[{title:"示例书籍 1",author:"作者名称",year:"2024",pages:"300",language:"简体中文",filesize:"10 MB",extension:"PDF",publisher:"示例出版社",source:"Z-Library",platform_id:"zlibrary"},{title:"示例书籍 2",author:"示例作者",year:"2023",pages:"250",language:"英文",filesize:"8 MB",extension:"EPUB",publisher:"Example Press",source:"Z-Library",platform_id:"zlibrary"}]}},computed:{getSortTitle:function(){switch(this.sortOrder){case"none":return"点击降序排列";case"desc":return"点击升序排列";case"asc":return"点击取消排序";default:return"默认排序标题"}},getSortIcon:function(){switch(this.sortOrder){case"none":return"bi-dash";case"desc":return"bi-sort-down";case"asc":return"bi-sort-up";default:return"bi-dash"}},sortedBooks:function(){return this.sortBooks(this.books)},sortedExampleBooks:function(){return this.sortBooks(this.exampleBooks)}},methods:{toggleSort:function(){switch(this.sortOrder){case"none":this.sortOrder="desc";break;case"desc":this.sortOrder="asc";break;case"asc":this.sortOrder="none";break;default:this.sortOrder="none"}this.persistSortOrder(this.sortOrder)},persistSortOrder:function(e){localStorage.setItem("bookSortOrder",e)},sortBooks:function(e){var a=this;return"none"===this.sortOrder?e:(0,ke.A)(e).sort((function(e,s){var t=parseInt(e.year,10)||0,r=parseInt(s.year,10)||0;return t===r?e.title.localeCompare(s.title):"asc"===a.sortOrder?t-r:r-t}))}}},ve=(0,_.A)(pe,[["render",he],["__scopeId","data-v-7bea03e2"]]),fe=ve;var me=window.location.origin+"/api";const Le={name:"App",components:{SearchBar:E,SearchResults:fe},data:function(){return{searchResults:[],platforms:[{id:"zlibrary",name:"Z-Library",available:!0,total:0}],hasSearched:!1}},methods:{handleSearch:function(e){var a=this;return(0,d.A)((0,c.A)().mark((function s(){var t,r;return(0,c.A)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,a.hasSearched=!0,a.searchResults=[],s.next=5,C.A.get("".concat(me,"/zlibrary/s/").concat(encodeURIComponent(e)));case 5:t=s.sent,t.data&&(a.searchResults=t.data.books,t.data.platform_status&&(r=t.data.platform_status,a.platforms=[{id:r.id,name:r.name,available:r.available,total:r.total}])),s.next=14;break;case 9:s.prev=9,s.t0=s["catch"](0),console.error("Search failed:",s.t0),a.searchResults=[],a.platforms=a.platforms.map((function(e){return(0,u.A)((0,u.A)({},e),{},{available:!1,total:0})}));case 14:case"end":return s.stop()}}),s,null,[[0,9]])})))()}}},ge=(0,_.A)(Le,[["render",n]]),ye=ge;var Se=(0,t.Ef)(ye);Se.mount("#app")}},a={};function s(t){var r=a[t];if(void 0!==r)return r.exports;var o=a[t]={exports:{}};return e[t].call(o.exports,o,o.exports,s),o.exports}s.m=e,(()=>{var e=[];s.O=(a,t,r,o)=>{if(!t){var l=1/0;for(u=0;u<e.length;u++){for(var[t,r,o]=e[u],i=!0,n=0;n<t.length;n++)(!1&o||l>=o)&&Object.keys(s.O).every((e=>s.O[e](t[n])))?t.splice(n--,1):(i=!1,o<l&&(l=o));if(i){e.splice(u--,1);var c=r();void 0!==c&&(a=c)}}return a}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[t,r,o]}})(),(()=>{s.d=(e,a)=>{for(var t in a)s.o(a,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};s.O.j=a=>0===e[a];var a=(a,t)=>{var r,o,[l,i,n]=t,c=0;if(l.some((a=>0!==e[a]))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(n)var u=n(s)}for(a&&a(t);c<l.length;c++)o=l[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},t=self["webpackChunkebook_search"]=self["webpackChunkebook_search"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var t=s.O(void 0,[504],(()=>s(492)));t=s.O(t)})();
//# sourceMappingURL=app.94d2ccae.js.map